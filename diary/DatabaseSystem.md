###12/4/2019 9:26:40 PM 
###You were not made to live as brutes, but to follow virtue and knowledge.
**不要像畜生一样活着，要追求美德和知识。**
###<center>设计一套权限管理系统的数据库结构</center>
####用户权限管理数据库设计（RBAC)
	RBAC(Role-Based Access Control,基于角色的访问控制），就是通过角色与权限进行关联。简单来说，一个用户拥有若干角色，每一个角色拥有若干权限。这样，就构造成“用户-角色-权限“的授权模型。在这种模型中，用户与角色之间，角色与权限之间，一般者是多对多的关系。（如下图）
![](./img/RBAC1.png)

	角色是什么？可以理解为一定数量的权限的集合，权限的载体。例如：一个论坛系统，“超级管理员”，“版主”都是角色。版主可管理版内的贴子、可管理版内的用户等，这些是权限。要给某个用户授予这些权限，不需要直接权限授予用户，可将“版主”这个角色赋予该用户。
	
![](./img/RBAC2.png)

	在应用系统中，权限表现成什么？对功能模块的操作，对上传文件的修改，菜单的访问，甚至页面上某个人按钮，某个图片的可见性控制，都可属于权限的范畴。有些权限设计，会把功能操作作为一类，而把文件、菜单、页面元素等作为一类，这样构成了“用户-角色-权限-资源”的授权模型。而在左数据表建模时，可把功能和资源统一管理，也就是都直接与权限表想关联，这就可能更具有便捷性和易扩展性。（见下图）

![](./img/RBAC3.png)

>>注意：需留意权限表中有一列“权限类型”，我们根据他的取值来区分是哪一类权限，如“MENU”表示菜单的访问权限，"OPERATION"表示功能模块的操作权限、”FILE"表示文件的修改权限、”ELEMENT“表示页面元素的可见性控制等。

* 这样设计的优势：
  1. 不需要区分那些是权限操作，那些是资源，（实际上，有时候也不好区分，比如菜单，它是权限呢还是功能模块）
  2. 方便扩展，当系统要对新的东西进行权限控制时，我只需要建立一个新的关联表“权限xx关联表",并确定这类权限的权限类型字符串。

>>需注意：权限表和权限菜单关联表、权限菜单关联表与菜单表都是一对一关系（文件、页面权限点、功能操作等同理）。也就是每添加一个菜单，就得同时往这三个表中个插入一条记录。这样可以不需要权限菜单关联表，让权限表与菜单表直接关联，此时，须在权限表中新增一列用来保存菜单的ID,权限表通过“权限类型”和这个ID来区分是那种类型下的那条记录。

**RBAC权限模型的扩展模型的完整设计图如下：**
![](./img/RBAC4.png)

***
	RBAC认为授权实际就是who，what，how三者之间的关系，即who对what进行how的操作。Who,权限的拥有者或主体（如Principal、User、Group、Role、Actor等等）；
	what,权限针对的对象或资源（Resource,Class);
	How,具体的权限（Privilege,正向授权与负向授权），简单的说就是我们拖过个给角色授权，然后将附有权利的角色施加到某个用户上，这样用户就可以实施相应的权利了。通过中间角色的身份，使权限管理更加灵活；角色的权利可以灵活地改变了，用户角色的身份可以随着场所的不同而发生改变，这样这套RBAC就几乎可以运用到所有的权限管理的模块上了。
####RBAC的分类
	1. 核心RABC0:这是权限管理的核心部分，其他的版本都是建立在0的基础上的（最基本的用户-角色-权限模型）
	
![](./img/RBACclass0.png)
	
	通常情况下，RBAC0模型就可以解决权限模型，是最通用的。图中描述了
		1，用户和角色是多对多的关系，表示一个用户在不同的场景下可以拥有不同的角色，例如项目经理也可以是架构师等；当然一个角色也可以给多个用户，例如一个项目中多个组长等。
		需要注意的是：用户和许可进行分离，是彼此相互独立，使权限的授权认证更加灵活。
		2. 角色和许可（权限）是多对多的关系，表示角色可以拥有多分权利，同一个权利可以授给多个角色都是非常容易理解的，在现实生活中，当官级别不同权限不同的情景，其实这个模型就是对权限这方面的一个抽象，联系生活就非常容易了。
	
**表的设计：**
![](./img/RBACclass1.png)

	2. RBAC1，基于RBAC0模型，进行了角色的分层，也就是说角色上有了上下级的区别，存在了继承包含关系，也就是前边说过的适合于用树展现的哪种自关联的结构，这种模型合适于角色之间的层次明确，包含明确。但是认为用第一种模型也是可以的，只不过第一种可能会有数据冗余，没有这种更加面向对象化而已。(在RBAC0的基础上加入了子角色，引入了继承，子角色可以继承父角色的所有权限。)

![](./img/RBACclass2.png)

	 3. RBAC2，也是基于RBAC0模型的基础上，进行了角色的访问控制。a,RBAC2中的一个基本限制时互斥角色的限制，互斥角色是指各自权限互相制约的两个角色。对于这类角色一个用户在某一次活动中只能被分配其中的一个角色，不能同时获得两个角色的使用权。常举的例子：在审计活动中，一个角色不能同时被指派给会计角色和审计员角色；b,是指角色的权利权利是有限的，用户有用的角色也是有限的，当然分配用户时也是有限的，不能进行无限制的分配用户，例如公司的领导人有限的；c,是指要想获得较高的权限，要首先拥有低一级的权限。就像我们生活中，国家主席是从副主席中选举的一样。看一下它的类图吧：(增加了对角色的一些限制：
       角色互斥：不能为同一用户分配两个互斥的角色；
       基数约束：某一角色对应的用户数量受限，分配得到该角色的用户数不能超过某个特定值，比如公司的副总不能超过多少人；
       先决条件角色：要想获得高级别权限，首先得拥有低级别的权限；
       运行时互斥：一个用户具有多个角色时，某些角色不可在运行过程中同时激活。)


![](./img/RBACclass3.png)

	 4. RBAC3，也就是最全面级的权限管理，它是基于RBAC0的基础上，将RBAC1和RBAC2进行整合了，最前面，也最复杂的：

![](./img/RBACclass4.png)

####RBAC支持的公认安全原则：最小特权原则、责任分离原则和数据抽象原则
1. 最小特权原则得到支持，是因为RBAC模型中可以通过限制分配给角色权限的多少和大小来实现，分配给与某用户对应的角色的权限只要不超过该用户完成其任务的需要就可以了。
2. 责任分离原则的实现，是因为RBAC模型中可以通过在完成敏感任务过程中分配两个责任上互相约束的两个角色来实现，例如清查账目时，只需要设置财务管理员和会计两个角色参加就可以了。
3. 数据抽象原则是借助抽象许可权这样的概念实现的，如在账目管理活动中，可以使用信用、借方等抽象许可权，而不是使用操作系统提供的读、写、执行的那个具体的许可权。但RBAC并不强迫实现这些原则，安全管理员可以允许配置RBAC模型使他不支持这些原则。因此，RBAC支持数据抽象程度与RBAC模型的实现细节有关。

####一个系统的权限分类：
	功能权限：指系统的模块、页面、按钮、文本、元素等根据用户所具有的权限决定是否进行显示。
	数据权限：指在页面中要显示的数据，针对不同用户显示的数据不同，比如公司不同部门所能查看的文件列表不同。
	操作权限：用户在系统中进行的素有动作、交互。

****
****
###12/5/2019 3:07:52 PM 
####[ER模型](https://blog.csdn.net/lvshihua/article/details/24185329)
#####1.什么是ER模型
	实体-联系图(Entity-RelationDiagram)用来建立数据模型，在数据库系统概论中数据概念设计阶段，形成一个独立于机器，独立于DBMS的ER图模型。通常将它简称为ER图，相应的可把ER图描绘的数据模型成为ER模型。
#####2.为什么出现ER模型
	如果把用户信息需求得到的数据存储格式转换成DBMS能处理的逻辑模型，这样往往被 牵扯到更多的细节限制方面，而不能集中在最重要的信息组织结构和处理模型上。当外界环境发生变化时，设计结果就难以适应这个变化。为了改善这种情况，在需求分析阶段和逻辑设计之间增加了概念设计阶段，从用户角度看待数据及处理需求和约束，而后产生一个反应用户观点的概念模型，在概念模型设计中，最著名的方法就是ER方法，它接近于人的思维，容易理解，与计算机无关，用户容易接受。
#####3.ER
![](./img/ER.gif)

	实体：一个数据对象，指应用中可以区别的客观存在的事物。例如：小狗
	联系：表示一个或多个实体之间的关联关系。例如：老师与学生之间存在着授课关系。
	属性：实体的某一个特性称为属性。例如：某个人的姓名，年龄等。
	完整ER模型图如下：
![](./img/ER1png.png)

####4.总结
	ER模型被广泛应用在概念设计中，在软件开发的需求分析阶段，我们从用户的需求出发，对数据进行抽象，绘制ER图，这样一方面有效控制设计的复杂度，一方面可以更容易与用户交流